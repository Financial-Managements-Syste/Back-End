<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="sqlite_setup.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="4832"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><table title="SavingsGoals" custom_title="0" dock_id="4" table="4,12:mainSavingsGoals"/><dock_state state="000000ff00000000fd0000000100000002000005bb00000387fc0100000002fb000000160064006f0063006b00420072006f00770073006500310100000000000003b20000000000000000fb000000160064006f0063006b00420072006f00770073006500340100000000000005bb0000011e00ffffff000005bb0000000000000004000000040000000800000008fc00000000"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="Budgets" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="65"/><column index="2" value="52"/><column index="3" value="78"/><column index="4" value="87"/><column index="5" value="118"/><column index="6" value="99"/><column index="7" value="91"/><column index="8" value="69"/><column index="9" value="62"/><column index="10" value="71"/><column index="11" value="74"/><column index="12" value="64"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Categories" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="76"/><column index="2" value="98"/><column index="3" value="92"/><column index="4" value="71"/><column index="5" value="111"/><column index="6" value="64"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="SavingsGoals" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="49"/><column index="2" value="52"/><column index="3" value="167"/><column index="4" value="95"/><column index="5" value="101"/><column index="6" value="87"/><column index="7" value="159"/><column index="8" value="159"/><column index="9" value="79"/><column index="10" value="64"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Transactions" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="90"/><column index="2" value="52"/><column index="3" value="78"/><column index="4" value="55"/><column index="5" value="106"/><column index="6" value="106"/><column index="7" value="71"/><column index="8" value="110"/><column index="9" value="159"/><column index="10" value="159"/><column index="11" value="64"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Users" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="50"/><column index="2" value="71"/><column index="3" value="151"/><column index="4" value="159"/><column index="5" value="239"/><column index="6" value="159"/><column index="7" value="64"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 1*">CREATE TABLE Users (
    user_id INTEGER PRIMARY KEY AUTOINCREMENT,
    username VARCHAR(255) NOT NULL UNIQUE,
    email VARCHAR(255) NOT NULL UNIQUE,
    password_hash VARCHAR(255) NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    is_synced INTEGER DEFAULT 0
);

CREATE TABLE Categories (
    category_id INTEGER PRIMARY KEY AUTOINCREMENT,
    category_name VARCHAR(255) NOT NULL UNIQUE,
    category_type VARCHAR(255) NOT NULL CHECK(category_type IN ('Income', 'Expense')),
    description VARCHAR(255),
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    is_synced INTEGER DEFAULT 0,
	sync_status TEXT DEFAULT 'NEW',
	is_deleted INTEGER DEFAULT 0
);

ALTER TABLE Categories ADD COLUMN sync_status TEXT DEFAULT 'NEW';
ALTER TABLE Categories ADD COLUMN is_deleted INTEGER DEFAULT 0;



DROP TABLE Categories;


CREATE TABLE Transactions (
    transaction_id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    category_id INTEGER NOT NULL,
    amount REAL NOT NULL CHECK(amount &gt; 0),
    transaction_type VARCHAR(255) NOT NULL CHECK(transaction_type IN ('Income', 'Expense')),
    transaction_date DATE NOT NULL,
    description VARCHAR(255),
    payment_method VARCHAR(255),
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    is_synced INTEGER DEFAULT 0,
	sync_status TEXT DEFAULT 'NEW',
	is_deleted INTEGER DEFAULT 0,
    FOREIGN KEY (user_id) REFERENCES Users(user_id) ON DELETE CASCADE,
    FOREIGN KEY (category_id) REFERENCES Categories(category_id) ON DELETE RESTRICT
);

DROP TABLE Transactions;


CREATE TABLE Budgets (
    budget_id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    category_id INTEGER NOT NULL,
	budget_name VARCHAR(255),
	Budget_description VARCHAR(255),
    budget_amount REAL NOT NULL CHECK(budget_amount &gt; 0),
    budget_period VARCHAR(255) NOT NULL CHECK(budget_period IN ('Daily', 'Weekly', 'Monthly', 'Yearly')),
    start_date DATE NOT NULL,
    end_date DATE NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    is_synced INTEGER DEFAULT 0,
	sync_status TEXT DEFAULT 'NEW',
	is_deleted INTEGER DEFAULT 0,
    FOREIGN KEY (user_id) REFERENCES Users(user_id) ON DELETE CASCADE,
    FOREIGN KEY (category_id) REFERENCES Categories(category_id) ON DELETE RESTRICT,
    CHECK(end_date &gt; start_date)
);

ALTER TABLE Budgets ADD COLUMN sync_status TEXT DEFAULT 'NEW';
ALTER TABLE Budgets ADD COLUMN is_deleted INTEGER DEFAULT 0;


DROP TABLE Budgets;

CREATE TABLE SavingsGoals (
    goal_id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    goal_name VARCHAR(255) NOT NULL,
    target_amount REAL NOT NULL CHECK(target_amount &gt; 0),
    current_amount REAL DEFAULT 0 CHECK(current_amount &gt;= 0),
    target_date DATE NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    status VARCHAR(255) DEFAULT 'Active' CHECK(status IN ('Active', 'Completed', 'Cancelled')),
    is_synced INTEGER DEFAULT 0,
	sync_status TEXT DEFAULT 'NEW',
	is_deleted INTEGER DEFAULT 0,
    FOREIGN KEY (user_id) REFERENCES Users(user_id) ON DELETE CASCADE
);

CREATE INDEX transactions_user ON Transactions(user_id);
CREATE INDEX transactions_date ON Transactions(transaction_date);
CREATE INDEX budgets_user ON Budgets(user_id);
CREATE INDEX savings_user ON SavingsGoals(user_id);

INSERT INTO Users (username, email, password_hash) VALUES
('Sithil', 'sithil@gmail.com', 'hashed_password_123'),
('semitha', 'Semitha@gmail.com', 'hashed_password_456'),
('manuli', 'mauli@gmail.com', 'hashed_password_789');

DROP TABLE Users;
DELETE FROM Users WHERE user_id IN (1,2,3);

INSERT INTO Categories (category_name, category_type, description) VALUES
('Salary', 'Income', 'Monthly salary'),
('Freelance', 'Income', 'Freelance income'),
('Groceries', 'Expense', 'Food and groceries'),
('Transport', 'Expense', 'Transportation costs'),
('Utilities', 'Expense', 'Electricity, water, internet'),
('Entertainment', 'Expense', 'Movies, games, subscriptions'),
('Healthcare', 'Expense', 'Medical expenses'),
('Rent', 'Expense', 'Monthly rent');

INSERT INTO Transactions (user_id, category_id, amount, transaction_type, transaction_date, description, payment_method)
VALUES 
 (1, 2, 5000.00, 'Income', '2025-10-01', 'October Salary', 'Bank Transfer'),
 (1, 3, 150.50, 'Expense', '2025-10-02', 'Weekly groceries', 'Credit Card'),
 (1, 4, 45.00, 'Expense', '2025-10-03', 'Uber rides', 'Debit Card'),
 (1, 8, 1200.00, 'Expense', '2025-10-01', 'Monthly rent', 'Bank Transfer'),
 (2, 2, 4500.00, 'Income', '2025-10-01', 'October Salary', 'Bank Transfer'),
 (2, 3, 200.00, 'Expense', '2025-10-02', 'Grocery shopping', 'Cash'),
 (2, 6, 50.00, 'Expense', '2025-10-03', 'Netflix subscription', 'Credit Card');




INSERT INTO Budgets (user_id, category_id, budget_name, Budget_description, budget_amount, budget_period, start_date, end_date, is_synced)
VALUES 
(1, 3, 'Groceries Weekly', 'Weekly budget for groceries', 150.00, 'Weekly', '2025-10-01', '2025-10-07', 0),
(1, 4, 'Monthly Rent', 'Monthly apartment rent', 1200.00, 'Monthly', '2025-10-01', '2025-10-31', 1),
(1, 6, 'Daily Coffee', 'Daily coffee expenses', 5.00, 'Daily', '2025-10-06', '2025-10-07', 0),
(2, 3, 'Yearly Travel', 'Vacation budget for the year', 3000.00, 'Yearly', '2025-01-01', '2025-12-31', 0);



DELETE FROM Budgets Where budget_id IN (5,6,7,8);

INSERT INTO SavingsGoals (user_id, goal_name, target_amount, current_amount, target_date) VALUES
(1, 'Emergency Fund', 10000.00, 2500.00, '2026-12-31'),
(1, 'Vacation to Europe', 5000.00, 1200.00, '2026-06-30'),
(2, 'New Car Down Payment', 15000.00, 3000.00, '2026-12-31');


SELECT 'BEFORE SYNC - SQLITE UNSYNCED RECORDS' as status;
SELECT * FROM Transactions WHERE is_synced = 0;


UPDATE Transactions SET is_synced = 1 WHERE user_id = 1;
UPDATE Budgets SET is_synced = 1 WHERE user_id = 1;
UPDATE SavingsGoals SET is_synced = 1 WHERE user_id = 1;


DELETE FROM Users WHERE user_id = 4;

SELECT COUNT() FROM Transactions;


sELECT COUNT(*) FROM Transactions;


DELETE FROM Budgets;
DELETE FROM sqlite_sequence WHERE name = 'Budgets';</sql><current_tab id="0"/></tab_sql></sqlb_project>
